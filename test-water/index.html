<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Test</title>
	<style type='text/css'>
        body {
            margin: 0;
            overflow: hidden;
			background-color: #ADBEED;
        }
    </style>
</head>
<body>
<script id="vertexShader" type="x-shader/x-vertex">
	varying vec2 vUv;
	void main() 
	{ 
		//lets keep the vertices as is, they are altered via the update
		//back in test.js
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position,
		1.0 );
	}
</script>

<script id="fragmentShader" type="x-shader/x-vertex"> 
	uniform sampler2D baseTexture;
	uniform float baseSpeed;
	uniform float repeatCol;
	uniform float repeatRow;

	uniform sampler2D noiseTexture;
	uniform float noiseScale;

	uniform sampler2D blendTexture;
	uniform float blendSpeed;
	uniform float blendOffset;

	uniform float time;
	uniform float alpha;

	varying vec2 vUv;

	void main() 
	{
		vec2 uvTimeShift = vUv + vec2( -0.7, 1.5 ) * time * baseSpeed;	
		vec4 noiseGeneratorTimeShift = texture2D( noiseTexture, uvTimeShift );
		vec2 uvNoiseTimeShift = vUv + noiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.b );
		vec4 baseColor = texture2D( baseTexture, uvNoiseTimeShift * vec2 (repeatCol, repeatRow ) );

		vec2 uvTimeShift2 = vUv + vec2( 1.3, -1.7 ) * time * blendSpeed;	
		vec4 noiseGeneratorTimeShift2 = texture2D( noiseTexture, uvTimeShift2 );
		vec2 uvNoiseTimeShift2 = vUv + noiseScale * vec2( noiseGeneratorTimeShift2.g, noiseGeneratorTimeShift2.b );
		vec4 blendColor = texture2D( blendTexture, 
									uvNoiseTimeShift2 * vec2(repeatCol, repeatRow) )
										- blendOffset * vec4(1.0, 1.0, 1.0, 1.0);

		vec4 theColor = baseColor + blendColor;
		theColor.a = alpha;
		gl_FragColor = theColor;
	}
</script>
	<!--<script src="http://code.createjs.com/createjs-2013.12.12.min.js"></script>-->
	<script src="js/lib/preloadjs-0.4.1.min.js"></script>
	<script src="js/loader.js"></script>
</body>
</html>
